{"version":3,"sources":["wordCloud.jsx"],"names":[],"mappings":"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","file":"wordCloud-compiled.js","sourcesContent":["(function(){\n\n    scify.WordCloud = React.createClass({\n        getInitialState: function() {\n          return {\n              consultationid: this.props.consultationid,\n              frequency_list: [],\n              busy: false,\n              display: false\n          };\n        },\n        refreshComments : function(){\n            var instance = this;\n            if (instance.state.commentsCount > instance.state.comments.length )\n                instance.getCommentsFromServer.call(instance);\n            else if (instance.state.display)\n                instance.setVisibibility.call(instance,false);\n            else\n                instance.setVisibibility.call(instance,true);\n        },\n        getConsWordCloudFromServer : function(consultationId, wordCloudPath){\n\n            console.log(\"getWordCloudFromServer\");\n            var instance = this;\n            var promise = $.ajax({\n                method: \"GET\",\n                url: wordCloudPath,\n                cache:false,\n                data:{\n                    consultation_id :consultationId\n                },\n                beforeSend: function(){\n                    instance.state.busy=true;\n                    instance.state.display = true;\n                    instance.setState(instance.state);\n                },\n                success : function(data){\n                    console.log(data);\n                    var arr = $.map(data, function(el) {\n                        var results = [];\n                        for(var item in el) {\n                            //console.log(el[item]);\n                            results.push({\"text\":el[item].term, \"size\":Math.floor(el[item].freq)})\n                        }\n                        return results;\n                    });\n                    instance.state.frequency_list = arr;\n                    console.log(instance.state.frequency_list);\n                },\n                complete: function(){\n                    instance.state.busy=false;\n                    instance.state.display = true;\n                    instance.setState(instance.state);\n                },\n                error: function(x,z,y){\n                    console.log(x);\n                }\n            });\n\n            return promise;\n        },\n        getArticleWordCloudFromServer : function(articleId, wordCloudPath, commentsNum){\n            this.state.frequency_list = [];\n            console.log(articleId);\n            var instance = this;\n            var promise = $.ajax({\n                method: \"GET\",\n                url: wordCloudPath,\n                cache:false,\n                data:{\n                    article_id :articleId,\n                    max_terms : 30\n                },\n                beforeSend: function(){\n                    instance.state.frequency_list = [];\n                    var chart = document.getElementById(\"wordCloudChart\");\n                    while (chart.firstChild) {\n                        chart.removeChild(chart.firstChild);\n                    }\n                    instance.state.busy=true;\n                    instance.state.display = true;\n                    instance.setState(instance.state);\n                },\n                success : function(data){\n                    var multiplier = 2;\n                    var sizes = 0;\n                    var average;\n                    if(commentsNum < 20) {\n                        multiplier = 5;\n                    }\n                    for(var i=0; i<data.results.length ; i++) {\n                        sizes += data.results[i].freq;\n                    }\n                    average = sizes / data.results.length;\n                    if(average < 3) {\n                        multiplier = 12;\n                    }\n                    var arr = $.map(data, function(el) {\n                        var results = [];\n                        for(var item in el) {\n                            results.push({\"text\":el[item].term, \"size\":Math.floor(el[item].freq * multiplier)})\n                            sizes += el[item].freq;\n                        }\n                        return results;\n                    });\n\n                    instance.state.frequency_list = arr;\n                },\n                complete: function(){\n                    instance.state.busy=false;\n                    instance.state.display = true;\n                    instance.setState(instance.state);\n                },\n                error: function(x,z,y){\n                    console.log(x);\n                }\n            });\n\n            return promise;\n        },\n        drawD3 : function() {\n            var fill = d3.scale.category20();\n            var instance = this;\n            if(this.state.frequency_list.length > 0) {\n                var color = d3.scale.linear()\n                    .domain([0, 1, 2, 3, 4, 5, 6, 10, 15, 20, 100])\n                    .range([\"#ddd\", \"#ccc\", \"#bbb\", \"#aaa\", \"#999\", \"#888\", \"#777\", \"#666\", \"#555\", \"#444\", \"#333\", \"#222\"]);\n\n                var color = d3.scale.linear()\n                    .domain([0, 1, 2, 3, 4, 5, 6, 10, 15, 20, 100])\n                    .range([\"#ddd\", \"#ccc\", \"#bbb\", \"#aaa\", \"#999\", \"#888\", \"#777\", \"#666\", \"#555\", \"#444\", \"#333\", \"#222\"]);\n\n                d3.layout.cloud().size([800, 300])\n                    .words(this.state.frequency_list)\n                    .rotate(function () {\n                        return ~~(Math.random() * 2) * 90;\n                    })\n                    .font(\"Impact\")\n                    .fontSize(function (d) {\n                        return d.size +2;\n                    })\n                    .padding(5)\n                    .on(\"end\", draw)\n                    .start();\n\n                function draw(words) {\n                    console.log(words);\n                    d3.select(\"#wordCloudChart\").append(\"svg\")\n                        .attr(\"width\", \"100%\")\n                        .attr(\"height\", 500)\n                        .append(\"g\")\n                        .attr(\"transform\", \"translate(500,250)\")\n                        .selectAll(\"text\")\n                        .data(words)\n                        .enter().append(\"text\")\n                        .style(\"font-size\", function (d) {\n                            return d.size + \"px\";\n                        })\n                        .style(\"font-family\", \"Impact\")\n                        .style(\"fill\", function(d, i) { return fill(i); })\n                        .attr(\"text-anchor\", \"middle\")\n                        .attr(\"transform\", function (d) {\n                            return \"translate(\" + [d.x, d.y] + \")\";\n                        })\n                        .text(function (d) {\n                            return d.text;\n                        });\n\n                    instance.state.frequency_list = [];\n                }\n            } else {\n                return (\n                    <div id=\"explanation\">Δεν βρέθηκαν δεδομένα.</div>\n                );\n            }\n        },\n        render: function() {\n            if(this.state.display) {\n                if (this.state.busy) {\n                    return (\n                        <div>\n                            <scify.ReactLoader display={this.state.busy}/>\n                        </div>\n                    );\n                } else {\n                    console.log(\"drawing now\");\n                    this.drawD3();\n                }\n            }\n            return (\n                <div></div>\n            );\n        }\n    });\n\n})()\n\n\n"]}