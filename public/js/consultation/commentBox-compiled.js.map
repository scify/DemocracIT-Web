{"version":3,"sources":["commentBox.jsx"],"names":[],"mappings":"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","file":"commentBox-compiled.js","sourcesContent":["(function(){\n\n\n    scify.CommentBox = React.createClass({\n        getInitialState : function(){\n            return {comments: []};\n        },\n        getCommentsFromServer : function(url){\n            var instance = this;\n            //todo: cancel any previous events\n            $.ajax({\n                method: \"POST\",\n                url: url,\n                beforeSend: function(){\n                    instance.state.busy=true;\n                    instance.setState(instance.state);\n                },\n                success : function(data){\n                    instance.state.comments = data;\n                    instance.state.busy=false;\n                    instance.state.display=true;\n                    instance.setState(instance.state);\n\n                },\n                error: function(x,z,y){\n                    alert(x)\n                }\n            })\n        },\n        saveComment : function(url,data){\n            var instance = this;\n\n            var comment = {\n                consultationId : this.props.consultationid,\n                articleId: this.props.articleid,\n                body : data.body,\n                annTagId: data.annTagId,\n                annotatedText: data.annotatedText,\n                discussionThreadId : this.props.discussionthreadid,\n\n                fullName : \"full name\",\n                tagText: data.tagText,\n                dateAdded : new Date()\n            };\n\n            //todo: cancel any previous events\n            $.ajax({\n                method: \"POST\",\n                url: url,\n                data:comment,\n                beforeSend:function(){\n                    instance.state.display=true;\n                    instance.state.busy=true;\n                    instance.setState(instance.state);\n                },\n                success : function(response){\n                    instance.state.comments.push(comment);\n                },\n                complete: function(error){\n                    instance.state.busy=false;\n\n                    instance.state.display = instance.comments.length>0;\n                    instance.setState(instance.state);\n                }\n            })\n\n        },\n        setVisibibility : function(display){\n            this.state.display=display;\n            this.setState(this.state);\n        },\n        refreshComments : function(url){\n            var instance = this;\n            if (!instance.state.comments || instance.state.comments.length==0)\n                instance.getCommentsFromServer.call(instance,url);\n            else if (instance.state.display)\n                instance.setVisibibility.call(instance,false);\n            else\n                instance.setVisibibility.call(instance,true);\n        },\n        toogleBox: function(){\n            this.state.display= !this.state.display;\n            this.setState(this.state);\n        },\n        render: function() {\n            if (this.state.busy)\n            {\n                return (\n                    <div className=\"loading-wrp\">\n                        <div className=\"spinner-loader\">\n                            ...\n                        </div>\n                    </div>\n                );\n            }\n            var classes = classNames(\"commentBox\",{ hide :!this.state.display});\n\n            return (\n                <div className={classes}>\n                    <a onClick={this.toogleBox}>{this.state.display? \"Κλεισιμο\" : \"Ανοιγμα\"}</a>\n                    <CommentForm />\n                    <CommentList data={this.state.comments} />\n                </div>\n\n            );\n        }\n    });\n    var CommentForm = React.createClass({\n        render: function() {\n            return (\n                <div className=\"commentForm\">\n                    {/*\n                    <form action=\"/home/save\" method=\"post\">\n                        <div>\n                            Επισημείωση για το τμήμα κειμένου:\n                            <blockquote></blockquote></div>\n                        <div>\n                            <hr/>\n                            <select name=\"tagId\">\n                                <option>Υπόδειξη προβλήματος:</option>\n                                <option value=\"-1\">πρόβλημα 1</option>\n                                <option value=\"-2\">πρόβλημα 2</option>\n                                <option value=\"-3\">πρόβλημα 3</option>\n                            </select>\n                        </div>\n                        <div className=\"comment-wrap\">\n                            Θα ηθελα να δηλωσω οτι:\n                            <textarea name=\"comment\"></textarea>\n                        </div>\n                        <input type=\"hidden\" name=\"consultationId\" value=\"{this.props.consulationid}\"/>\n                        <input type=\"hidden\" name=\"articleId\" value=\"{this.props.articleid}\"/>\n                        <input type=\"hidden\" name=\"startIndex\" value=\"-1\"/>\n                        <input type=\"hidden\" name=\"endIndex\" value=\"-1\"/>\n                        <input type=\"hidden\" name=\"annotation-tag\" value=\"{this.state.annotationId}\"/>\n                        <input type=\"hidden\" name=\"text\" value=\"{this.state.annotation.text}\"/>\n                        <button className=\"btn blue\" type=\"submit\">Καταχώρηση</button>\n                        <button className=\"close btn red\" type=\"button\"  >Κλείσιμο</button>\n                    </form>\n                     */}\n                </div>\n            );\n        }\n    });\n    var CommentList = React.createClass({\n        render: function() {\n            var commentNodes = this.props.data.map(function (comment) {\n                return (\n                    <Comment data={comment} />\n                );\n            });\n\n            return (\n                <div className=\"commentList\">\n                    {commentNodes}\n                </div>\n            );\n        }\n    });\n    var Comment = React.createClass({\n\n        render: function() {\n            var date =moment(this.props.data.dateAdded).format('llll');\n            //new Date(this.props.data.dateAdded).toDateString()\n            // console.log(this.props.data.dateAdded);\n            var tagInfo ;\n            if (this.props.data.annTagId>0 && this.props.data.tagText && this.props.data.tagText .length>0){\n                tagInfo = <div className=\"tag\"><span >{this.props.data.tagText }</span></div>\n            }\n\n            return (\n                <div className=\"comment\">\n                    <div className='avatar'>\n                        <img src=\"/assets/images/profile_default.jpg\" />\n                    </div>\n                    <div className='body'>\n                        <span className=\"commentAuthor\">{this.props.data.fullName}</span>\n                        <span dangerouslySetInnerHTML={{__html: this.props.data.body}}></span>\n                        {tagInfo}\n                    </div>\n                    <div className=\"options\">\n                        <a className=\"agree\" href=\"#\">Συμφωνώ<i className=\"fa fa-thumbs-o-up\"></i></a>\n                        <a className=\"disagree\" href=\"#\">Διαφωνώ<i className=\"fa fa-thumbs-o-down\"></i></a>\n                        <a className=\"reply\" href=\"#\">Απάντηση <i className=\"fa fa-reply\"></i></a>\n                        <span className=\"date\">{date}</span>\n                    </div>\n                </div>\n            );\n        }\n    });\n})()\n\n\n"]}